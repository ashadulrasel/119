<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Live Stream — Premium Live TV</title>
  <meta name="theme-color" content="#0b1020" />
  <meta name="description" content="Premium Live TV with liquid-glass UI, HLS player, login tiers, quality switch, PiP, banners, responsive." />
  <link rel="preconnect" href="https://cdn.jsdelivr.net" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://images.unsplash.com" />
  <link rel="preconnect" href="https://d2zihajmogu5jn.cloudfront.net" />
  <link rel="preconnect" href="https://commondatastorage.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0b1020;
      --glass:rgba(255,255,255,.08);
      --stroke:rgba(255,255,255,.18);
      --txt:#e6ecff;
      --muted:#a9b5d6;
      --brand:#6be7ff;
      --brand2:#7b7bff;
      --accent:#ff4d8d;
      --success:#26e58d;
      --warning:#ffb84d;
      --danger:#ff5d5d;
      --shadow:0 10px 40px rgba(0,0,0,.35), inset 0 0 1px rgba(255,255,255,.08);
      --radius:18px;
      --blur:18px;
      --speed:26s;
      --actions-w: 340px; /* JS দিয়ে হিসেব করা হবে */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:'Plus Jakarta Sans', system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:var(--txt);
      background:
        radial-gradient(1200px 700px at 10% 10%, rgba(107,231,255,.15), transparent 40%),
        radial-gradient(900px 600px at 90% 0%, rgba(123,123,255,.18), transparent 35%),
        url('https://images.unsplash.com/photo-1583409430135-1ccd865c940e?q=80&w=1170&auto=format&fit=crop&ixlib=rb-4.1.0') center/cover fixed no-repeat #0b1020;
      overflow-x:hidden;
    }
    .container{width:min(1280px,92vw); margin:0 auto}
    .glass{
      background:linear-gradient(180deg, rgba(255,255,255,.09), rgba(255,255,255,.04));
      backdrop-filter:blur(var(--blur)) saturate(130%);
      -webkit-backdrop-filter:blur(var(--blur)) saturate(130%);
      border:1px solid var(--stroke);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
    }
    a{color:inherit; text-decoration:none}
    button{font:inherit; color:inherit}

    /* Splash Intro — প্রিমিয়াম ব্র্যান্ড ইন্ট্রো */
    .splash {
      position: fixed; inset: 0; display: grid; place-items: center;
      background: radial-gradient(600px 400px at 50% 30%, rgba(107,231,255,.12), transparent 40%), #060a18;
      z-index: 9999;
      animation: splashFade 1.2s ease 1.5s forwards;
    }
    @keyframes splashFade { to { opacity: 0; visibility: hidden; } }
    .splash-inner {
      display: flex; align-items: center; gap: 16px;
      padding: 16px 22px; border-radius: 18px;
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      border:1px solid var(--stroke);
      box-shadow: 0 20px 60px rgba(0,0,0,.55);
      animation: popIn .9s cubic-bezier(.2,.9,.2,1) both;
    }
    .splash-logo {
      width: 68px; height: 68px; border-radius: 50%;
      position: relative; overflow: hidden;
      box-shadow: 0 14px 34px rgba(0,0,0,.6);
    }
    .splash-logo::after{
      content:''; position:absolute; inset:-10px; border-radius:50%;
      background: conic-gradient(from 0deg, rgba(107,231,255,.55), rgba(255,134,201,.45), rgba(123,123,255,.5), rgba(107,231,255,.55));
      filter: blur(16px); animation: ringSpin 12s linear infinite;
    }
    .splash-title {
      font-weight: 900; font-size: 28px; letter-spacing: .3px;
      background: linear-gradient(90deg,#fff,var(--brand),var(--brand2),#fff);
      -webkit-background-clip:text; background-clip:text; color: transparent;
      background-size: 220% 100%; animation: textShimmer 6s linear infinite;
      text-shadow: 0 2px 18px rgba(107,231,255,.28);
    }
    @keyframes ringSpin{to{transform:rotate(360deg)}}
    @keyframes textShimmer{0%{background-position:0% 50%}100%{background-position:220% 50%}}
    @keyframes popIn{from{transform:scale(.7);opacity:0}to{transform:scale(1);opacity:1}}

    /* NAV — grid + stable actions width */
    .nav{position:sticky; top:0; z-index:90; margin:12px auto 8px; padding:10px 14px}
    .nav-inner{
      display:grid; align-items:center; gap:12px;
      grid-template-columns:max-content 1fr max-content;
    }
    .brand{display:flex; align-items:center; gap:16px; padding:6px 10px; border-radius:14px}
    .logo-wrap{
      position:relative; width:80px; height:80px; flex:0 0 80px; border-radius:50%;
      display:grid; place-items:center; animation:logoFloat 4.8s ease-in-out infinite; will-change:transform;
    }
    .logo-wrap::before{
      content:''; position:absolute; inset:-8px; border-radius:50%;
      background:conic-gradient(from 0deg, rgba(107,231,255,.55), rgba(255,134,201,.45), rgba(123,123,255,.5), rgba(107,231,255,.55));
      filter:blur(18px); animation:ringSpin 18s linear infinite;
    }
    .brand img{
      width:80px; height:80px; border-radius:50%;
      box-shadow:0 12px 28px rgba(0,0,0,.5);
      animation:popIn .8s cubic-bezier(.2,.9,.2,1) both; will-change:transform, filter;
    }
    .btext{
      position:relative;
      font-weight:900; letter-spacing:.4px; font-size:28px;
      background:linear-gradient(90deg, #fff, var(--brand), var(--brand2), #fff);
      -webkit-background-clip:text; background-clip:text; color:transparent;
      background-size:260% 100%; animation:textShimmer 5.5s linear infinite;
      filter:drop-shadow(0 2px 10px rgba(107,231,255,.35)); will-change:background-position, transform;
    }
    .btext::after{
      content:''; position:absolute; top:0; left:-30%;
      width:30%; height:100%; pointer-events:none;
      background:linear-gradient(90deg, transparent, rgba(255,255,255,.45), transparent);
      transform:skewX(-20deg);
      animation:shineSweep 4.8s ease-in-out infinite; mix-blend-mode:screen; opacity:.6;
    }
    @keyframes logoFloat{0%{transform:translateY(0)}50%{transform:translateY(-3px)}100%{transform:translateY(0)}}
    @keyframes shineSweep{0%{left:-40%} 55%{left:110%} 100%{left:110%}}

    .nav-links{
      display:flex; align-items:center; gap:10px; justify-content:center;
      overflow:auto; white-space:nowrap; padding:0 6px 6px; scrollbar-width:none;
    }
    .nav-links::-webkit-scrollbar{display:none}
    .pill-btn{
      padding:10px 14px; border-radius:999px; border:1px solid var(--stroke);
      background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      transition:all .25s ease; cursor:pointer; will-change:transform;
    }
    .pill-btn:hover{transform:translateY(-1px); border-color:rgba(255,255,255,.35)}
    .primary{background:linear-gradient(90deg, var(--brand), var(--brand2)); color:#06111a; font-weight:700; border:none}
    .login-btn{background:linear-gradient(90deg, #ff8ab3, #a98bff); color:#1b0c20; font-weight:700; border:none}

    .nav-actions{
      display:flex; align-items:center; gap:10px; justify-content:flex-end;
      width:clamp(280px, var(--actions-w), 460px);
      flex:0 0 clamp(280px, var(--actions-w), 460px);
    }
    #loginOpen{white-space:nowrap}
    .profile{display:none; align-items:center; gap:10px; min-width:0}
    .avatar{width:36px; height:36px; border-radius:50%; background:url('https://avatars.githubusercontent.com/u/192325222?v=4') center/cover}
    .role{padding:4px 8px; border-radius:9px; font-weight:800}
    .role.B{background:linear-gradient(90deg,#d6f0ff,#9edbff); color:#06161d}
    .role.Pro{background:linear-gradient(90deg,#a5b4ff,#7aa6ff); color:#0d0b2b}
    .role.ProPlus{background:linear-gradient(90deg,#ffb1e2,#ff86c9); color:#2b0019}

    /* Mobile Menu */
    .mobile-menu-btn {
      display: none;
      background: transparent;
      border: none;
      color: var(--txt);
      cursor: pointer;
      padding: 8px;
      border-radius: 8px;
    }
    .mobile-menu-btn:hover { background: rgba(255,255,255,0.1); }
    .mobile-menu {
      position: fixed; top: 0; left: -100%; width: 320px; height: 100vh;
      background: rgba(11, 16, 32, 0.96);
      backdrop-filter: blur(10px);
      z-index: 100;
      transition: left 0.3s ease; overflow-y: auto; padding: 20px;
      border-right: 1px solid var(--stroke);
      box-shadow: 0 10px 50px rgba(0,0,0,.55);
    }
    .mobile-menu.active { left: 0; }
    .mobile-menu-header{ display:flex; justify-content:space-between; align-items:center; margin-bottom: 16px; }
    .mobile-menu-close { background: transparent; border: none; color: var(--txt); font-size: 24px; cursor: pointer; }
    .mobile-menu-links { display: flex; flex-direction: column; gap: 10px; margin-bottom:16px }
    .mobile-menu-links .pill-btn { width: 100%; text-align: left; }
    .mobile-overlay { position: fixed; inset:0; background: rgba(0,0,0,0.5); z-index: 99; display: none; }
    .mobile-overlay.active { display: block; }

    /* Mobile account area */
    .mobile-account { margin-top: 10px; padding-top: 12px; border-top:1px solid var(--stroke); }
    .mobile-account-header { font-weight:800; margin-bottom:8px; }
    .mobile-user {
      display:flex; align-items:center; gap:10px; padding:10px; border-radius:12px;
      background: rgba(255,255,255,0.06); border:1px solid var(--stroke);
    }
    .mobile-user .avatar { width:44px; height:44px }
    .mobile-account-actions { display:flex; flex-direction:column; gap:8px; margin-top:10px }
    .logout-btn { background: linear-gradient(90deg, #ff7a7a, #ff4d5e); border: none; color: white; font-weight: 700; }

    /* Info Rail (below Nav) */
    .info-rail{margin:10px auto 12px; padding:10px 12px; position:relative; overflow:hidden}
    .info-rail::before{
      content:''; position:absolute; inset:-2px; border-radius:calc(var(--radius) + 2px);
      background:conic-gradient(from 0deg, rgba(107,231,255,.35), rgba(255,134,201,.35), rgba(123,123,255,.35), rgba(107,231,255,.35));
      filter:blur(12px); opacity:.5; z-index:0; pointer-events:none; animation:spinBorder 12s linear infinite;
      mask:linear-gradient(#000,#000) content-box, linear-gradient(#000,#000); -webkit-mask-composite:xor; mask-composite:exclude; padding:2px;
    }
    @keyframes spinBorder{to{transform:rotate(360deg)}}
    .ir-inner{position:relative; z-index:1; display:grid; gap:10px}
    .ir-tabs{display:flex; gap:8px; flex-wrap:wrap}
    .ir-tab{padding:8px 12px; border-radius:999px; border:1px solid var(--stroke); background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03)); cursor:pointer; transition:all .2s; font-weight:700}
    .ir-tab.active{color:#06111a; border:none; background:linear-gradient(90deg, #aef, #7df, #a98bff); box-shadow:0 6px 24px rgba(107,231,255,.28)}
    .ir-track-wrap{position:relative; overflow:hidden; border-radius:12px; border:1px solid var(--stroke); background:rgba(255,255,255,.04)}
    .ir-track{display:flex; gap:28px; white-space:nowrap; padding:10px 14px; align-items:center; animation:irScroll var(--speed) linear infinite; will-change:transform}
    .ir-track:hover{animation-play-state:paused}
    @keyframes irScroll{from{transform:translateX(0)} to{transform:translateX(-50%)}}
    .ir-item{display:flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px; background:linear-gradient(135deg, rgba(255,255,255,.14), rgba(255,255,255,.06)); border:1px solid rgba(255,255,255,.2); box-shadow:0 4px 16px rgba(0,0,0,.25); font-weight:600}
    .ir-tag{padding:4px 8px; border-radius:999px; font-size:12px; font-weight:800; color:#06111a; background:linear-gradient(90deg,#ff7a7a,#ff4d5e)}
    .ir-tag.up{background:linear-gradient(90deg,#a5b4ff,#7aa6ff)}
    .ir-tag.news{background:linear-gradient(90deg,#9ef,#7df)}

    /* HERO slider (Ken Burns + arrows) */
    .slider{position:relative; overflow:hidden; border-radius:var(--radius); margin:18px 0}
    .slides{display:flex; transition:transform .7s cubic-bezier(.2,.8,.2,1); will-change:transform}
    .slide{min-width:100%; aspect-ratio:16/9; max-height:480px; position:relative; overflow:hidden; display:grid; place-items:center; background:linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.5))}
    .slide img{position:absolute; inset:0; width:100%; height:100%; object-fit:cover; animation:kenburns 16s ease-in-out infinite}
    @keyframes kenburns{0%{transform:scale(1)}50%{transform:scale(1.07) translate(1.2%,-1.2%)}100%{transform:scale(1)}}
    .s-overlay{position:absolute; inset:0; background:linear-gradient(180deg, rgba(0,0,0,.3), rgba(0,0,0,.6))}
    .s-content{position:relative; z-index:2; align-self:end; padding:18px}
    .s-title{font-size:22px; font-weight:900; margin-bottom:6px}
    .s-sub{color:var(--muted); margin-bottom:10px}
    .s-cta{display:flex; gap:10px}
    .cta{padding:10px 14px; border-radius:12px; border:1px solid var(--stroke); background:rgba(255,255,255,.08); cursor:pointer}
    .cta.primary{background:linear-gradient(90deg,#aef,#7df,#a98bff); color:#07121b; font-weight:800; border:none}
    .dots{position:absolute; bottom:10px; left:50%; transform:translateX(-50%); display:flex; gap:8px; z-index:3}
    .dot{width:10px; height:10px; border-radius:50%; background:rgba(255,255,255,.35); border:none; cursor:pointer}
    .dot.active{background:#fff}
    .arrow{position:absolute; top:50%; transform:translateY(-50%); z-index:3; width:42px; height:42px; border-radius:50%; border:1px solid var(--stroke); background:rgba(0,0,0,.35); display:grid; place-items:center; cursor:pointer; color:#fff}
    .arrow:hover{background:rgba(0,0,0,.5)}
    .prev{left:10px}.next{right:10px}

    /* Sections / Filters / Channel grid */
    .section{padding:14px}
    .hrow{display:flex; align-items:center; justify-content:space-between; gap:10px}
    .h1{font-size:22px; font-weight:900; letter-spacing:.3px}
    .muted{color:var(--muted)}
    .filter-bar{display:flex; flex-wrap:wrap; gap:10px; margin-top:12px}
    .chip{border-radius:999px; padding:9px 14px; border:1px solid var(--stroke); background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03)); cursor:pointer; transition:all .2s}
    .chip.active{border-color:#9edbff; box-shadow:0 6px 20px rgba(107,231,255,.18), inset 0 0 0 1px rgba(255,255,255,.12)}
    .grid{display:grid; gap:14px; margin:16px 0 28px}
    @media(min-width:520px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media(min-width:840px){.grid{grid-template-columns:repeat(3,1fr)}}
    @media(min-width:1100px){.grid{grid-template-columns:repeat(4,1fr)}}

    .card{position:relative; overflow:hidden; border-radius:16px; background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)); border:1px solid var(--stroke); box-shadow:var(--shadow); cursor:pointer; min-height:170px; transition:transform .25s ease, box-shadow .25s ease}
    .card:hover{transform:translateY(-2px) scale(1.01); box-shadow:0 12px 36px rgba(0,0,0,.46)}
    .thumb{display:grid; place-items:center; aspect-ratio:16/9; background:radial-gradient(600px 200px at 50% -20%, rgba(255,255,255,.1), transparent 40%), rgba(0,0,0,.25)}
    .thumb .logo-frame{width:90%; height:80%; display:grid; place-items:center}
    .thumb img{max-width:100%; max-height:100%; width:auto; height:auto; object-fit:contain; image-rendering:-webkit-optimize-contrast; filter:drop-shadow(0 2px 8px rgba(0,0,0,.5)); transition:transform .35s ease}
    .card:hover .thumb img{transform:scale(1.05)}
    .meta{display:flex; align-items:center; justify-content:space-between; padding:10px 12px}
    .title{font-weight:700}
    .badges{display:flex; gap:6px; flex-wrap:wrap}
    .badge{padding:4px 8px; border-radius:8px; font-size:12px; border:1px solid rgba(255,255,255,.2); background:linear-gradient(135deg, rgba(255,255,255,.12), rgba(255,255,255,.06)); animation:float .9s ease-in-out infinite alternate}
    .b-live{background:linear-gradient(90deg,#ff7a7a,#ff4d5e); color:#2a0000; border:none; font-weight:800}
    .b-pro{background:linear-gradient(90deg,#a5b4ff,#7aa6ff); color:#0a102a; border:none; font-weight:800}
    .b-free{background:linear-gradient(90deg,#c2ffd4,#66ffad); color:#052a17; border:none; font-weight:800}
    .b-hd{background:linear-gradient(90deg,#9ef,#7df)}
    .b-2k{background:linear-gradient(90deg,#fdd87b,#ffb84d)}
    .b-4k{background:linear-gradient(90deg,#8df,#6bf)}
    .b-8k{background:linear-gradient(90deg,#ffb1e2,#ff86c9)}
    .b-B{background:linear-gradient(90deg,#d6f0ff,#9edbff); color:#07161f; font-weight:800; border:none}
    @keyframes float{from{transform:translateY(0)}to{transform:translateY(-2px)}}

    /* Events (premium glass tiles) */
    .events{display:grid; gap:14px; margin:12px 0 22px}
    @media(min-width:780px){.events{grid-template-columns:repeat(2,1fr)}}
    .event{
      display:flex; gap:12px; align-items:center; padding:12px; border-radius:16px;
      background:linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03)); border:1px solid var(--stroke); box-shadow:var(--shadow);
      position: relative; overflow: hidden;
    }
    .event::before{
      content:''; position:absolute; left:0; top:0; bottom:0; width:4px; border-radius:4px;
      background: linear-gradient(180deg, #9ef, #7df);
    }
    .ev-left{width:66px; height:66px; border-radius:12px; overflow:hidden; flex:0 0 66px; background:#000; border:1px solid rgba(255,255,255,.15)}
    .ev-left img{width:100%; height:100%; object-fit:cover}
    .ev-mid{flex:1}
    .ev-title{font-weight:900; font-size:16px; margin-bottom:4px}
    .ev-sub{font-size:12px; color:var(--muted)}
    .ev-right{display:flex; flex-direction:column; align-items:flex-end; gap:6px}
    .etime{font-weight:800; color:#bfe9ff}
    .etag{padding:6px 10px; border-radius:999px; background:linear-gradient(90deg,#9ef,#7df); color:#071621; font-weight:800}

    /* Ribbon (above footer) */
    .ribbon{margin:16px auto; padding:12px; position:relative; overflow:hidden}
    .rib-title{font-weight:900; margin-bottom:8px}
    .rib-wrap{position:relative; overflow:hidden; border-radius:12px; border:1px solid var(--stroke); background:rgba(255,255,255,.04)}
    .rib-track{display:flex; gap:12px; padding:10px; animation:irScroll calc(var(--speed) + 8s) linear infinite}
    .rib-track:hover{animation-play-state:paused}
    .rib-card{min-width:280px; max-width:320px; display:flex; gap:10px; align-items:center; background:linear-gradient(135deg, rgba(255,255,255,.12), rgba(255,255,255,.06)); border:1px solid rgba(255,255,255,.2); border-radius:12px; overflow:hidden; padding:8px; box-shadow:0 6px 22px rgba(0,0,0,.3)}
    .rib-img{width:64px; height:42px; border-radius:8px; overflow:hidden; flex:0 0 64px; background:#000}
    .rib-img img{width:100%; height:100%; object-fit:cover}
    .rib-meta{display:flex; flex-direction:column; gap:4px}
    .rib-tag{font-size:12px; font-weight:800; padding:2px 8px; border-radius:999px; width:max-content; color:#06111a}
    .rib-tag.notice{background:linear-gradient(90deg,#ff7a7a,#ff4d5e)}
    .rib-tag.update{background:linear-gradient(90deg,#a5b4ff,#7aa6ff)}
    .rib-tag.news{background:linear-gradient(90deg,#9ef,#7df)}

    /* Footer */
    .footer{margin:16px auto 26px; padding:12px 14px}
    .socials{display:flex; gap:10px; flex-wrap:wrap}
    .socials a{padding:10px 14px; border-radius:999px; border:1px solid var(--stroke); background:rgba(255,255,255,.06)}

    /* Player — Cinematic + custom controls */
    .modal{position:fixed; inset:0; display:none; place-items:center; z-index:100}
    .modal.active{display:grid}
    .modal-bg{position:absolute; inset:0; background:rgba(0,0,0,.6); backdrop-filter: blur(6px); animation:fadeIn .25s}
    @keyframes fadeIn{from{opacity:0} to{opacity:1}}
    .modal-body{position:relative; width:min(1100px, 94vw); border-radius:18px; overflow:hidden; background:linear-gradient(180deg, rgba(0,0,0,.65), rgba(0,0,0,.85)); border:1px solid rgba(255,255,255,.18); box-shadow:0 14px 60px rgba(0,0,0,.6)}
    .player-wrap{position:relative; background:#000; border-radius:18px; overflow:hidden}
    .player-wrap::before{content:''; position:absolute; inset:0; pointer-events:none; border-radius:18px; box-shadow:inset 0 0 0 1px rgba(255,255,255,.08), inset 0 0 80px rgba(107,231,255,.08)}
    video{width:100%; height:auto; background:#000; aspect-ratio:16/9}
    .spinner{position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); width:54px; height:54px; border-radius:50%; border:3px solid rgba(255,255,255,.2); border-top-color:#9edbff; animation:spin 1s linear infinite; z-index:4}
    @keyframes spin{to{transform:translate(-50%,-50%) rotate(360deg)}}
    .toast{position:absolute; top:10px; right:10px; padding:10px 12px; border-radius:10px; background:rgba(255,93,93,.15); border:1px solid rgba(255,93,93,.35); color:#ffdede; font-weight:700; z-index:5}
    .hidden{display:none !important}

    .player-ui{position:absolute; inset:0; display:flex; flex-direction:column; justify-content:space-between; pointer-events:none}
    .p-top,.p-bottom{display:flex; align-items:center; justify-content:space-between; gap:10px; padding:10px; pointer-events:auto}
    .p-top{background:linear-gradient(180deg, rgba(0,0,0,.65), transparent)}
    .p-bottom{background:linear-gradient(0deg, rgba(0,0,0,.7), transparent)}
    .p-title{display:flex; align-items:center; gap:10px; font-weight:900; font-size:16px}
    .live-dot{width:10px; height:10px; border-radius:50%; background:#ff4d5e; box-shadow:0 0 12px #ff4d5e}

    .controls{display:flex; align-items:center; gap:8px}
    .ctl{border-radius:10px; border:1px solid rgba(255,255,255,.2); background:rgba(255,255,255,.08); padding:8px 10px; cursor:pointer; transition:all .2s; display:flex; align-items:center; gap:6px; color:#fff}
    .ctl:hover{background:rgba(255,255,255,.15)}
    .quality-menu{position:relative}
    .q-list{position:absolute; right:0; top:110%; background:rgba(0,0,0,.85); border:1px solid rgba(255,255,255,.18); border-radius:10px; padding:6px; display:none; min-width:100px}
    .q-list button{display:block; width:100%; text-align:left; white-space:nowrap}
    .quality-menu.open .q-list{display:block}

    .progress{display:flex; align-items:center; gap:8px; flex:1; padding:0 6px}
    .time{font-size:12px; color:#d7e8ff; min-width:60px; text-align:center}
    input[type="range"].bar{
      -webkit-appearance:none; appearance:none; height:6px; width:100%; background:rgba(255,255,255,.2); border-radius:999px; outline:none;
    }
    input[type="range"].bar::-webkit-slider-thumb{
      -webkit-appearance:none; appearance:none; width:14px; height:14px; border-radius:50%; background:#9edbff; box-shadow:0 0 0 6px rgba(158,219,255,.25);
    }
    input[type="range"].vol{
      -webkit-appearance:none; appearance:none; height:6px; width:90px; background:rgba(255,255,255,.2); border-radius:999px; outline:none;
    }
    input[type="range"].vol::-webkit-slider-thumb{
      -webkit-appearance:none; appearance:none; width:12px; height:12px; border-radius:50%; background:#fff;
    }

    /* Premium profile dropdown */
    .profile-dropdown { position: relative; }
    .profile-menu {
      position: absolute; top: 100%; right: 0; margin-top: 8px;
      background: rgba(11, 16, 32, 0.96); backdrop-filter: blur(10px);
      border-radius: 12px; border: 1px solid var(--stroke); box-shadow: var(--shadow);
      padding: 12px; min-width: 260px; z-index: 100; opacity: 0; transform: translateY(-10px);
      transition: opacity 0.25s, transform 0.25s; pointer-events: none;
    }
    .profile-menu.active { opacity:1; transform: translateY(0); pointer-events:auto; }
    .profile-header { display:flex; align-items:center; gap:12px; padding-bottom:10px; border-bottom:1px solid var(--stroke); margin-bottom:10px }
    .profile-info { flex: 1; }
    .profile-name { font-weight: 800; font-size: 16px; }
    .profile-tier { font-size: 12px; color: var(--muted); }
    .profile-actions { display:flex; flex-direction:column; gap:8px; }
    .profile-action-btn { padding: 8px 12px; border-radius: 8px; border: 1px solid var(--stroke); background: rgba(255,255,255,0.05); color: var(--txt); text-align: left; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; gap: 8px; }
    .profile-action-btn:hover { background: rgba(255,255,255,0.1); }

    /* Responsive */
    @media (max-width: 900px) {
      .nav-links { display: none; }
      .mobile-menu-btn { display: block; }
      .nav-inner { grid-template-columns: max-content 1fr max-content; }
    }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      .logo-wrap,.brand img,.btext,.btext::after,.ir-track,.rib-track,.slides,.slide img,.splash-inner{animation:none !important}
      .pill-btn,.card{transition:none !important}
    }
  </style>
</head>
<body>
  <!-- Premium Splash Intro -->
  <!-- ব্যাখ্যা (BN): এই স্প্ল্যাশ ইন্ট্রো লোডের সময় 1.5s দেখা যাবে, তারপর নিজে থেকে fade-out হবে -->
  <div class="splash" id="splash" aria-hidden="true">
    <div class="splash-inner">
      <div class="splash-logo">
        <img src="https://avatars.githubusercontent.com/u/192325222?v=4" alt="Brand" width="68" height="68" style="width:68px;height:68px;border-radius:50%;position:relative;z-index:1" />
      </div>
      <div class="splash-title">Live Stream</div>
    </div>
  </div>

  <!-- NAV -->
  <!-- ব্যাখ্যা (BN): Nav-এ ব্র্যান্ড, লিঙ্ক, আর ডানদিকে Login/Profile সেকশন আছে। মোবাইলে সব লিঙ্ক mobile drawer-এ যাবে -->
  <header class="nav glass container">
    <div class="nav-inner">
      <div class="brand">
        <div class="logo-wrap">
          <img src="https://avatars.githubusercontent.com/u/192325222?v=4" alt="Brand">
        </div>
        <div class="btext">Live Stream</div>
      </div>

      <nav class="nav-links">
        <a class="pill-btn" href="#home">Home</a>
        <a class="pill-btn" href="#channels">Channels</a>
        <a class="pill-btn" href="#events">Live Events</a>
        <a class="pill-btn primary" href="https://example.com" target="_blank" rel="noopener">Other Site 1</a>
        <a class="pill-btn primary" href="https://example.org" target="_blank" rel="noopener">Other Site 2</a>
      </nav>

      <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Open menu">
        <svg width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
      </button>

      <div class="nav-actions">
        <div class="profile profile-dropdown" id="profile">
          <div class="avatar" id="profileAvatar" title="Account"></div>
          <div class="profile-info">
            <div id="pname" style="font-weight:800">USER</div>
            <div class="muted" style="font-size:12px" id="pexp"></div>
          </div>
          <span id="prole" class="role">Tier</span>

          <!-- Premium Profile Dropdown -->
          <!-- ব্যাখ্যা (BN): প্রোফাইল ছবিতে ক্লিক করলে এই মেনু খুলবে; ইউজারের টায়ার, মেয়াদ, অ্যাকশনগুলো থাকবে -->
          <div class="profile-menu" id="profileMenu" aria-label="Profile menu">
            <div class="profile-header">
              <div class="avatar" style="width: 48px; height: 48px;"></div>
              <div class="profile-info">
                <div class="profile-name" id="profileName">USER</div>
                <div class="profile-tier" id="profileTier">Basic Plan</div>
                <div class="profile-tier" id="profileExpiry" style="margin-top:2px">Expires —</div>
              </div>
            </div>
            <div class="profile-actions">
              <button class="profile-action-btn" id="profileSettings">
                <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentColor" d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/></svg>
                Settings
              </button>
              <button class="profile-action-btn" id="profileSubscription">
                <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentColor" d="M12,6V9L16,5L12,1V4A8,8 0 0,0 4,12C4,13.57 4.46,15.03 5.24,16.26L6.7,14.8C6.25,13.97 6,13 6,12A6,6 0 0,1 12,6M18.76,7.74L17.3,9.2C17.74,10.04 18,11 18,12A6,6 0 0,1 12,18V15L8,19L12,23V20A8,8 0 0,0 20,12C20,10.43 19.54,8.97 18.76,7.74Z"/></svg>
                Subscription
              </button>
              <button class="profile-action-btn logout-btn" id="logoutBtn">Logout</button>
            </div>
          </div>
        </div>

        <button class="pill-btn login-btn" id="loginOpen">Login</button>
      </div>
    </div>
  </header>

  <!-- Mobile Menu -->
  <!-- ব্যাখ্যা (BN): মোবাইলে এই drawer-এ সব লিঙ্ক + অ্যাকাউন্ট অংশ থাকবে -->
  <div class="mobile-overlay" id="mobileOverlay"></div>
  <div class="mobile-menu" id="mobileMenu" aria-label="Mobile menu">
    <div class="mobile-menu-header">
      <div class="btext" style="font-size: 20px;">Live Stream</div>
      <button class="mobile-menu-close" id="mobileMenuClose" aria-label="Close menu">
        <svg width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12"/></svg>
      </button>
    </div>
    <div class="mobile-menu-links">
      <a class="pill-btn" href="#home">Home</a>
      <a class="pill-btn" href="#channels">Channels</a>
      <a class="pill-btn" href="#events">Live Events</a>
      <a class="pill-btn primary" href="https://example.com" target="_blank" rel="noopener">Other Site 1</a>
      <a class="pill-btn primary" href="https://example.org" target="_blank" rel="noopener">Other Site 2</a>
    </div>

    <!-- ডায়নামিক মোবাইল অ্যাকাউন্ট সেকশন (JS দিয়ে আপডেট হবে) -->
    <div class="mobile-account" id="mobileAccount"></div>
  </div>

  <!-- Info Rail (Below Nav) -->
  <!-- ব্যাখ্যা (BN): এই রেলে Notice/Updates/News ট্যাব আছে এবং কন্টেন্ট অটো-রোটেট করবে -->
  <div class="info-rail glass container" role="region" aria-label="Info Rail">
    <div class="ir-inner">
      <div class="ir-tabs">
        <button class="ir-tab active" data-tab="notice">Notice</button>
        <button class="ir-tab" data-tab="updates">Updates</button>
        <button class="ir-tab" data-tab="news">News</button>
      </div>
      <div class="ir-track-wrap">
        <div class="ir-track" id="irTrack"></div>
      </div>
    </div>
  </div>

  <!-- HERO BANNER -->
  <main class="container" id="home">
    <section class="slider glass" aria-label="Premium Banners">
      <button class="arrow prev" id="prevBtn" aria-label="Prev">
        <svg width="20" height="20" viewBox="0 0 24 24"><path fill="currentColor" d="M15.41 7.41 14 6 8 12l6 6 1.41-1.41L10.83 12z"/></svg>
      </button>
      <button class="arrow next" id="nextBtn" aria-label="Next">
        <svg width="20" height="20" viewBox="0 0 24 24"><path fill="currentColor" d="m8.59 16.59 4.58-4.59-4.58-4.59L10 6l6 6-6 6z"/></svg>
      </button>
      <div class="slides" id="slides">
        <div class="slide">
          <img src="https://iili.io/Kl05eku.jpg?q=80&w=1400&auto=format&fit=crop" alt="Banner 1">
          <div class="s-overlay"></div>
          <div class="s-content">
            <div class="s-title">Bangladesh • Pakistan</div>
            <div class="s-sub">Tonight 08:30</div>
            <div class="s-cta">
              <a class="cta primary" href="#channels">Explore Channels</a>
              <a class="cta" href="#events">Live Events</a>
            </div>
          </div>
        </div>
        <div class="slide">
          <img src="https://iili.io/KlGk4R9.jpg?q=80&w=1400&auto=format&fit=crop" alt="Banner 2">
          <div class="s-overlay"></div>
          <div class="s-content">
            <div class="s-title">Cinematic • Smooth</div>
            <div class="s-sub">Designed for Mobile • Tablet • TV • PC</div>
            <div class="s-cta">
              <a class="cta primary" href="#channels">Start Watching</a>
              <a class="cta" href="#events">Schedule</a>
            </div>
          </div>
        </div>
        <div class="slide">
          <img src="https://iili.io/KlMxAAb.webp?q=80&w=1400&auto=format&fit=crop" alt="Banner 3">
          <div class="s-overlay"></div>
          <div class="s-content">
            <div class="s-title">Bangladesh • Cricket Team</div>
            <div class="s-sub">Ultra-Smooth • Low-latency</div>
            <div class="s-cta">
              <a class="cta primary" href="#channels">Open Player</a>
              <a class="cta" href="#events">Explore</a>
            </div>
          </div>
        </div>
      </div>
      <div class="dots" id="dots"></div>
    </section>

    <!-- Channels -->
    <section class="glass section" id="channels">
      <div class="hrow">
        <div class="h1">Live TV Channels</div>
        <div class="muted">Select a category</div>
      </div>
      <div class="filter-bar" id="filterBar">
        <button class="chip active" data-filter="all">All</button>
        <button class="chip" data-filter="sports">Sports</button>
        <button class="chip" data-filter="bangladeshi">Bangladeshi</button>
        <button class="chip" data-filter="bangladesh+news">Bangladesh+News</button>
        <button class="chip" data-filter="news">News</button>
        <button class="chip" data-filter="movies">Movies</button>
        <button class="chip" data-filter="kids">Kids</button>
        <button class="chip" data-filter="music">Music</button>
        <button class="chip" data-filter="science">Science</button>
      </div>
      <div class="grid" id="channelGrid" aria-live="polite"></div>
    </section>

    <!-- Events -->
    <section class="glass section" id="events">
      <div class="hrow">
        <div class="h1">Live Events</div>
        <div class="muted">World-class events (Bangladesh Time)</div>
      </div>
      <div class="events" id="eventList"></div>
    </section>
  </main>

  <!-- Ribbon (Above Footer) -->
  <div class="ribbon glass container" role="region" aria-label="News Ribbon">
    <div class="rib-title">News • Updates</div>
    <div class="rib-wrap">
      <div class="rib-track" id="ribTrack"></div>
    </div>
  </div>

  <!-- FOOTER -->
  <footer class="footer glass container">
    <div class="hrow">
      <div>
        <div class="h1">Live Stream</div>
        <div class="muted">Smooth premium live TV experience</div>
      </div>
      <div class="socials">
        <a href="#" target="_blank" rel="noopener">Telegram</a>
        <a href="#" target="_blank" rel="noopener">Facebook</a>
        <a href="#" target="_blank" rel="noopener">Twitter/X</a>
        <a href="#" target="_blank" rel="noopener">YouTube</a>
        <a href="#" target="_blank" rel="noopener">Website</a>
      </div>
    </div>
  </footer>

  <!-- PLAYER MODAL -->
  <div class="modal" id="playerModal" aria-hidden="true" role="dialog" aria-label="Player">
    <div class="modal-bg" id="closePlayer"></div>
    <div class="modal-body">
      <div class="player-wrap">
        <div id="spinner" class="spinner hidden"></div>
        <div id="toast" class="toast hidden">Playback error</div>
        <video id="video" playsinline preload="metadata" muted></video>

        <div class="player-ui">
          <div class="p-top">
            <div class="p-title">
              <span class="live-dot"></span>
              <span id="playerTitle">Live</span>
            </div>
            <div class="controls">
              <div class="quality-menu ctl" id="qualityMenu">
                <span>Quality</span>
                <svg width="14" height="14" viewBox="0 0 24 24"><path fill="currentColor" d="M7 10l5 5 5-5z"/></svg>
                <div class="q-list" id="qualityList"></div>
              </div>
              <button class="ctl" id="pipBtn" title="Picture-in-Picture">
                <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentColor" d="M19 7H5v10h14V7m-2 8h-6v-4h6v4Z"/></svg>
              </button>
              <button class="ctl" id="fsBtn" title="Fullscreen">
                <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentColor" d="M14,3H21V10H19V6.41L13.41,12L12,10.59L17.59,5H14V3M10,21H3V14H5V17.59L10.59,12L12,13.41L6.41,19H10V21Z"/></svg>
              </button>
              <button class="ctl" id="closeBtn" title="Close">
                <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentColor" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12"/></svg>
              </button>
            </div>
          </div>

          <!-- Branding overlay -->
          <div class="p-brand" id="playerBrand" style="left:20px; top:50%; transform:translateY(-50%); display:flex; align-items:center; gap:12px; pointer-events:none; animation:popIn .9s ease both">
            <div class="plogo" style="position:relative; width:58px; height:58px; border-radius:50%">
              <img src="https://avatars.githubusercontent.com/u/192325222?v=4" alt="Brand" style="width:58px; height:58px; border-radius:50%; box-shadow:0 10px 24px rgba(0,0,0,.4)">
            </div>
            <div class="t" style="font-weight:900; font-size:22px; letter-spacing:.3px; background:linear-gradient(90deg, #fff, var(--brand), var(--brand2), #fff); -webkit-background-clip:text; background-clip:text; color:transparent; background-size:200% 100%; text-shadow:0 2px 18px rgba(107,231,255,.28); animation:textShimmer 6s linear infinite">Live Stream</div>
          </div>

          <div class="p-bottom">
            <div class="controls">
              <button class="ctl" id="playBtn" title="Play/Pause">
                <svg id="playIcon" width="16" height="16" viewBox="0 0 24 24"><path fill="currentColor" d="M8 5v14l11-7z"/></svg>
                <svg id="pauseIcon" width="16" height="16" viewBox="0 0 24 24" style="display:none"><path fill="currentColor" d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>
              </button>
              <button class="ctl" id="rewBtn" title="Back 10s">
                <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentColor" d="M11 7V3L6 8l5 5V9a4 4 0 1 1-4 4H5a6 6 0 1 0 6-6Z"/></svg>
              </button>
              <button class="ctl" id="fwdBtn" title="Forward 10s">
                <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentColor" d="M13 7V3l5 5-5 5V9a4 4 0 1 0 4 4h2a6 6 0 1 1-6-6Z"/></svg>
              </button>
              <button class="ctl" id="muteBtn" title="Mute/Unmute">
                <svg id="volIcon" width="16" height="16" viewBox="0 0 24 24"><path fill="currentColor" d="M14,3.23v17.53L7.77,16H3V8h4.77L14,3.23Z"/></svg>
                <svg id="muteIcon" width="16" height="16" viewBox="0 0 24 24" style="display:none"><path fill="currentColor" d="M12,4L9.91,6.09L12,8.18V4M4.27,3L3,4.27L7.73,9H3V15H7L12,20V13.27L16.25,17.5C15.04,18.5 13.57,19.19 12,19.45V21C14.39,20.68 16.5,19.5 18.07,17.77L19.73,19.43L21,18.16L4.27,3M19,12C19,10.81 18.67,9.69 18.09,8.73L19.57,7.25C20.5,8.79 21,10.54 21,12C21,13.46 20.5,15.21 19.57,16.75L18.09,15.27C18.67,14.31 19,13.19 19,12M16.5,12C16.5,11.25 16.3,10.54 15.96,9.93L17.45,8.45C18.13,9.56 18.5,10.76 18.5,12C18.5,13.24 18.13,14.44 17.45,15.55L15.96,14.07C16.3,13.46 16.5,12.75 16.5,12Z"/></svg>
              </button>
              <input class="vol" id="vol" type="range" min="0" max="1" step="0.02" value="1" title="Volume" />
            </div>

            <div class="progress">
              <span class="time" id="curTime">00:00</span>
              <input class="bar" id="seek" type="range" min="0" max="100" step="0.1" value="0" />
              <span class="time" id="durTime">LIVE</span>
            </div>

            <div class="controls">
              <div class="quality-menu ctl" id="qualityMenu2">
                <span>Quality</span>
                <svg width="14" height="14" viewBox="0 0 24 24"><path fill="currentColor" d="M7 10l5 5 5-5z"/></svg>
                <div class="q-list" id="qualityList2"></div>
              </div>
            </div>
          </div>
        </div> <!-- player-ui -->
      </div>
    </div>
  </div>

  <!-- AUTH MODAL -->
  <!-- ব্যাখ্যা (BN): অনুমোদিত অ্যাকাউন্ট ছাড়া non-free চ্যানেল চলবে না -->
  <div class="modal auth-modal" id="authModal" aria-hidden="true" role="dialog" aria-label="Auth">
    <div class="modal-bg" id="authClose"></div>
    <div class="modal-body glass" style="width:min(520px,94vw)">
      <div class="section">
        <h3 style="margin:8px 0 14px">Sign in</h3>
        <div style="display:flex;flex-direction:column;gap:10px">
          <label class="pill-btn" style="display:flex;align-items:center;gap:8px">
            <span>👤</span><input id="username" placeholder="Username" autocomplete="username" style="all:unset;flex:1" />
          </label>
          <label class="pill-btn" style="display:flex;align-items:center;gap:8px">
            <span>🔒</span><input id="password" type="password" placeholder="Password" autocomplete="current-password" style="all:unset;flex:1" />
          </label>
          <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap">
            <div class="muted" style="font-size:12px">Only approved accounts can sign in.</div>
            <button class="pill-btn" id="demoBtn">Demo</button>
          </div>
          <button class="pill-btn login-btn" id="loginBtn">Login</button>
        </div>
      </div>
    </div>
  </div>

  <!-- HLS.js -->
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.8/dist/hls.min.js"></script>

  <script>
  ;(()=>{
    /* ============================================================
       CONFIG / DATA
       ব্যাখ্যা (BN): নিচের অংশে ডাটাগুলো রাখা হয় — ইউজার অ্যাকাউন্ট, চ্যানেল, ইভেন্ট, নোটিশ
       ============================================================ */
    const ACCOUNTS = [
      // ব্যাখ্যা: অনুমোদিত ৩ ধরনের টায়ার — basic, pro, ultra (Pro+)
      { user:'basic', pass:'basic123', tier:'basic',  expires:'2027-12-31', label:'B'    },
      { user:'pro',   pass:'pro123',   tier:'pro',    expires:'2027-12-31', label:'Pro'  },
      { user:'ultra', pass:'ultra999', tier:'ultra',  expires:'2027-12-31', label:'Pro+' }
    ];

    // Channels — ডুপ্লিকেট/টাইপো ক্লিনআপ করা হয়েছে; Free চ্যানেলগুলো badges-এ 'Free' রয়েছে
    const CHANNELS = [
      // Bangladesh + News (free)
      { id:'ATN-News', name:'ATN News', category:'bangladesh+news',  logo:'https://upload.wikimedia.org/wikipedia/commons/thumb/4/4b/ATN_News_logo.svg/180px-ATN_News_logo.svg.png', url:'https://owrcovcrpy.gpcdn.net/bpk-tv/1706/output/1706-audio_113362_eng=113200-video=3224800.m3u8', badges:['Live','HD','Free','B'], tier:'basic' },
      { id:'Somoy-TV', name:'Somoy TV', category:'bangladesh+news',  logo:'https://upload.wikimedia.org/wikipedia/en/thumb/c/c4/SOMOY_TV_Logo.svg/250px-SOMOY_TV_Logo.svg.png', url:'https://owrcovcrpy.gpcdn.net/bpk-tv/1702/output/1702-audio_113322_eng=113200-video=3224800.m3u8', badges:['Live','HD','Free','B'], tier:'basic' },
      { id:'DBC-News', name:'DBC News', category:'bangladesh+news',  logo:'https://upload.wikimedia.org/wikipedia/commons/9/9f/DBC_News_logo.png', url:'https://bozztv.com/rongo/rongo-dbcnews/tracks-v2a1/mono.m3u8', badges:['Live','HD','Free','B'], tier:'basic' },
      { id:'Channel-24', name:'Channel 24', category:'bangladesh+news',  logo:'https://images.seeklogo.com/logo-png/42/1/channel-24-logo-png_seeklogo-424910.png', url:'https://owrcovcrpy.gpcdn.net/bpk-tv/1703/output/1703-audio_113332_eng=113200-video=3224800.m3u8', badges:['Live','HD','Free','B'], tier:'basic' },
      { id:'Ekattor-TV', name:'Ekattor TV', category:'bangladesh+news',  logo:'https://upload.wikimedia.org/wikipedia/bn/thumb/4/4a/%E0%A6%8F%E0%A6%95%E0%A6%BE%E0%A6%A4%E0%A7%8D%E0%A6%A4%E0%A6%B0_%E0%A6%9F%E0%A6%BF%E0%A6%AD%E0%A6%BF.svg/316px-%E0%A6%8F%E0%A6%95%E0%A6%BE%E0%A6%A4%E0%A7%8D%E0%A6%A4%E0%A6%B0_%E0%A6%9F%E0%A6%BF%E0%A6%AD%E0%A6%BF.svg.png', url:'https://owrcovcrpy.gpcdn.net/bpk-tv/1705/output/1705-audio_113352_eng=113200-video=3224800.m3u8', badges:['Live','HD','Free','B'], tier:'basic' },
      { id:'Ekhon-TV', name:'Ekhon TV', category:'bangladesh+news',  logo:'https://ekhon.tv/logo.png', url:'https://app24.jagobd.com.bd/c3VydmVyX8RpbEU9Mi8xNy8yMFDDEHGcfRgzQ6NTAgdEoaeFzbF92YWxIZTO0U0ezN1IzMyfvcEdsEfeDeKiNkVN3PTOmdFsaWRtaW51aiPhnPTI2/globaltv.stream/tracks-v1a1/mono.m3u8', badges:['Live','HD','Free','B'], tier:'basic' },
      { id:'Jamuna-TV', name:'Jamuna TV', category:'bangladesh+news',  logo:'https://upload.wikimedia.org/wikipedia/commons/thumb/f/fe/Jamuna_TV_logo.svg/512px-Jamuna_TV_logo.svg.png', url:'https://owrcovcrpy.gpcdn.net/bpk-tv/1701/output/1701-audio_113312_eng=113200-video=3224800.m3u8', badges:['Live','HD','Free','B'], tier:'basic' },

      // Bangladeshi (free)
      { id:'Channel-i', name:'Channel i', category:'bangladeshi',  logo:'https://upload.wikimedia.org/wikipedia/en/thumb/c/c5/Channel-i.svg/250px-Channel-i.svg.png', url:'https://live.dinesh29.com.np/stream/jiotv/channeli/stream_0.m3u8', badges:['Live','HD','Free','B'], tier:'basic' },
      { id:'ATN-Bangla', name:'ATN Bangla', category:'bangladeshi',  logo:'https://upload.wikimedia.org/wikipedia/en/thumb/e/e5/ATN_Bangla.svg/250px-ATN_Bangla.svg.png', url:'https://live.dinesh29.com.np/stream/jiotv/atnbangla/stream_0.m3u8', badges:['Live','HD','Free','B'], tier:'basic' },
      { id:'NTV', name:'NTV', category:'bangladeshi',  logo:'https://upload.wikimedia.org/wikipedia/en/thumb/e/e1/NTV_Bangladesh.svg/250px-NTV_Bangladesh.svg.png', url:'https://live.dinesh29.com.np/stream/jiotv/ntv/stream_0.m3u8', badges:['Live','HD','Free','B'], tier:'basic' },

      // Movies (Pro)
      { id:'B4U-Kadak', name:'B4U Kadak', category:'movies', logo:'https://jiotvimages.cdn.jio.com/dare_images/images/B4U_Kadak.png', url:'https://cdnb4u.wiseplayout.com/B4U_Kadak/HD720/HD720.m3u8', badges:['Live','HD','Pro'], tier:'pro' },
      { id:'Colors-Cineplex', name:'Colors Cineplex', category:'movies', logo:'https://jiotvimages.cdn.jio.com/dare_images/images/Colors_Cineplex.png', url:'https://live.dinesh29.com.np/stream/jiotv/colorscineplex/stream_0.m3u8', badges:['Live','HD','Pro'], tier:'pro' },

      // Kids (Free basic)
      { id:'Nick-Hindi', name:'Nick Hindi', category:'kids', logo:'https://live.dinesh29.com.np/logos/jiotv/nickhindi.png', url:'https://live.dinesh29.com.np/stream/jiotv/nickhindi/stream_0.m3u8', badges:['HD','Free','B'], tier:'basic' },

      // Science (Ultra / Pro+)
      { id:'Discovery-Bangla', name:'Discovery Bangla', category:'science', logo:'https://live.dinesh29.com.np/logos/jiotv/discoverybengali.png', url:'https://live.dinesh29.com.np/stream/jiotv/discoverybengali/stream_0.m3u8', badges:['Live','4k','Pro+'], tier:'ultra' },
      { id:'History-Hindi', name:'History TV18 Hindi', category:'science', logo:'https://live.dinesh29.com.np/logos/jiotv/historytv18hdhindi.png', url:'https://live.dinesh29.com.np/stream/jiotv/historytv18hdhindi/stream_0.m3u8', badges:['Live','4k','Pro+'], tier:'ultra' },

      // Sports (Pro)
      { id:'Star-Sports-2-Hindi', name:'Star Sports 2 Hindi', category:'sports', logo:'https://live.dinesh29.com.np/logos/jiotv/starsports2hindihd.png', url:'https://live.dinesh29.com.np/stream/jiotv/starsports2hindihd/stream_0.m3u8', badges:['Live','2k','Pro'], tier:'pro' },
      { id:'Star-Sports-Khel', name:'Star Sports Khel', category:'sports', logo:'https://live.dinesh29.com.np/logos/jiotv/starsportskhel.png', url:'https://live.dinesh29.com.np/stream/jiotv/starsportskhel/stream_0.m3u8', badges:['Live','2k','Pro'], tier:'pro' }
    ];

    // Info Tickers
    const TICKERS = {
      notice: [
        { text:'Server maintenance 12–1 AM today', icon:'⚠️', type:'notice' },
        { text:'Tier-based access; login required (non-free)', icon:'🔒', type:'notice' }
      ],
      updates: [
        { text:'Improved HLS buffering & quality switch', icon:'🎛️', type:'update' },
        { text:'PiP and keyboard shortcuts enhanced', icon:'✨', type:'update' }
      ],
      news: [
        { text:'Live: International football tournament', icon:'🏆', type:'news' },
        { text:'New movies — HD/4K', icon:'🎬', type:'news' }
      ]
    };

    // Ribbon cards
    const RIBBON = [
      { img:'https://images.unsplash.com/photo-1461896836934-ffe607ba8211?q=80&w=600&auto=format&fit=crop', text:'Breaking: New server node live', type:'update' },
      { img:'https://images.unsplash.com/photo-1517649763962-0c623066013b?q=80&w=600&auto=format&fit=crop', text:'Live Music Fest (HD)', type:'news' },
      { img:'https://images.unsplash.com/photo-1521417531039-94d3c6a86b45?q=80&w=600&auto=format&fit=crop', text:'Football: Final today', type:'news' }
    ];

    // Events (Bangladesh time উল্লেখ করে ISO +06:00 ফরম্যাট ব্যবহার করুন)
    // ব্যাখ্যা: start/end-এ Asia/Dhaka (+06:00) সহ ISO string দিন; JS তা সঠিকভাবে UTC-তে কনভার্ট করবে
    const EVENTS = [
      { title:'Cricket: Bangladesh vs Pakistan', img:'https://iili.io/KlGk4R9.jpg?q=80&w=600&auto=format&fit=crop',
        start:'2025-10-07T20:30:00+06:00', end:'2025-10-07T23:30:00+06:00' },
      { title:'SpaceX Launch (Demo)', img:'https://images.unsplash.com/photo-1446776811953-b23d57bd21aa?q=80&w=600&auto=format&fit=crop',
        start:'2025-10-10T21:00:00+06:00', end:'2025-10-10T22:00:00+06:00' },
      { title:'Football — Knockout', img:'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?q=80&w=600&auto=format&fit=crop',
        start:'2025-10-12T20:15:00+06:00', end:'2025-10-12T22:30:00+06:00' }
    ];

    /* ============================================================
       STATE / UTILS
       ============================================================ */
    let user = null, hls = null, currentChannel = null;
    let sliderIndex = 0, sliderTimer = null;
    let infoTab = 'notice', infoRotateTimer = null;

    const $ = s=>document.querySelector(s);
    const $$ = s=>document.querySelectorAll(s);

    // ব্যাখ্যা (BN): Bangladesh time-এ ফরম্যাট করার জন্য এই ফাংশন ব্যবহার করুন
    function formatBD(d, withDate=false){
      const dt = new Date(d);
      const opt = withDate
        ? { timeZone:'Asia/Dhaka', weekday:'short', month:'short', day:'2-digit', hour:'2-digit', minute:'2-digit' }
        : { timeZone:'Asia/Dhaka', hour:'2-digit', minute:'2-digit' };
      return new Intl.DateTimeFormat('en-GB', opt).format(dt);
    }
    function formatDate(d){ return new Date(d).toLocaleDateString('en-US',{year:'numeric',month:'short',day:'2-digit'}); }
    function isExpired(s){ return new Date() > new Date(s+'T23:59:59'); }
    function canWatch(tier){ if(!user) return false; if(user.tier==='ultra') return true; if(user.tier==='pro') return tier!=='ultra'; return tier==='basic'; }
    function isFree(ch){ return (ch.badges||[]).includes('Free'); }

    // Throttle helper
    function throttle(fn, ms){ let t=null; return (...a)=>{ if(t) return; t=setTimeout(()=>{ fn(...a); t=null; }, ms); }; }

    /* =========================
       NAV: stable actions width
       ========================= */
    function computeActionsWidth(){
      const login = $('#loginOpen'); const prof = $('#profile');
      if(!login || !prof) return;
      const wasLoginHidden = login.classList.contains('hidden');
      const prevProfDisplay = prof.style.display;

      login.classList.remove('hidden');
      prof.style.display = 'flex';

      const w = Math.max(login.getBoundingClientRect().width, prof.getBoundingClientRect().width) + 24;
      if(wasLoginHidden) login.classList.add('hidden');
      prof.style.display = prevProfDisplay || 'none';

      const finalW = Math.min(Math.max(280, Math.ceil(w)), 460);
      document.documentElement.style.setProperty('--actions-w', finalW + 'px');
    }
    window.addEventListener('resize', throttle(computeActionsWidth, 150));
    window.addEventListener('load', ()=>setTimeout(computeActionsWidth, 60));

    /* =========================
       Info Rail
       ========================= */
    function railData(tab){
      const list=TICKERS[tab]||[];
      return list.map(x=>({text:x.text, icon:x.icon, type:x.type, tag:tab==='notice'?'Notice':tab==='updates'?'Update':'News' }));
    }
    function renderInfoRail(tab='notice'){
      infoTab=tab;
      $$('.ir-tab').forEach(b=>b.classList.toggle('active', b.dataset.tab===tab));
      const track=$('#irTrack');
      const row=railData(tab).concat(railData(tab));
      track.innerHTML=row.map(x=>`<div class="ir-item"><span>${x.icon}</span><span class="ir-tag ${x.type==='update'?'up':x.type==='news'?'news':''}">${x.tag}</span><span>${x.text}</span></div>`).join('');
    }
    // ট্যাব ক্লিক করলে রিলোড
    $('.info-rail').addEventListener('click',e=>{const btn=e.target.closest('.ir-tab'); if(btn){ renderInfoRail(btn.dataset.tab); restartInfoRotate(btn.dataset.tab);} });

    // অটো-রোটেট (Notice → Updates → News)
    function startInfoRotate(){
      stopInfoRotate();
      infoRotateTimer = setInterval(()=>{
        infoTab = infoTab==='notice' ? 'updates' : infoTab==='updates' ? 'news' : 'notice';
        renderInfoRail(infoTab);
      }, 7000);
    }
    function stopInfoRotate(){ if(infoRotateTimer){ clearInterval(infoRotateTimer); infoRotateTimer=null; } }
    function restartInfoRotate(forceTab){ if(forceTab) infoTab=forceTab; startInfoRotate(); }
    // হোভারে pause
    const infoRailEl = $('.info-rail');
    infoRailEl.addEventListener('mouseenter', stopInfoRotate);
    infoRailEl.addEventListener('mouseleave', startInfoRotate);

    /* =========================
       HERO Slider
       ========================= */
    function initSlider(){
      const slides=$('#slides'), dots=$('#dots'), count=slides.children.length;
      dots.innerHTML=''; for(let i=0;i<count;i++){const b=document.createElement('button'); b.className='dot'+(i===0?' active':''); b.addEventListener('click',()=>go(i)); dots.appendChild(b);}
      $('#prevBtn').addEventListener('click',()=>go((sliderIndex-1+count)%count));
      $('#nextBtn').addEventListener('click',()=>go((sliderIndex+1)%count));
      function go(i){ sliderIndex=i; slides.style.transform=`translateX(-${i*100}%)`; [...dots.children].forEach((d,idx)=>d.classList.toggle('active', idx===i)); restart(); }
      function next(){ go((sliderIndex+1)%count); }
      function restart(){ if(sliderTimer) clearInterval(sliderTimer); sliderTimer=setInterval(next, 7000); }
      restart();
    }

    /* =========================
       Channels
       ========================= */
    function badges(ch){
      // ব্যাখ্যা: ব্যাজ ক্লাস ম্যাপিং
      const m={'Live':'b-live','HD':'b-hd','Free':'b-free','Pro':'b-pro','Pro+':'b-pro','B':'b-B','2k':'b-2k','4k':'b-4k','8k':'b-8k'};
      return ch.badges.map(b=>`<span class="badge ${m[b]||''}">${b}</span>`).join('');
    }
    function renderChannels(filter='all'){
      const g=$('#channelGrid'); g.innerHTML='';
      CHANNELS.filter(c=>filter==='all'||c.category===filter).forEach(ch=>{
        const el=document.createElement('div'); el.className='card'; el.tabIndex=0;
        el.innerHTML=`<div class="thumb"><div class="logo-frame">
            <img src="${ch.logo}" alt="${ch.name} logo" loading="lazy"
                 onerror="this.src='data:image/svg+xml;utf8,<?xml version=&quot;1.0&quot;?><svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;300&quot; height=&quot;170&quot;><rect width=&quot;100%&quot; height=&quot;100%&quot; fill=&quot;%23000&quot;/><text x=&quot;50%&quot; y=&quot;50%&quot; dominant-baseline=&quot;middle&quot; text-anchor=&quot;middle&quot; fill=&quot;%23aaa&quot; font-family=&quot;Arial&quot; font-size=&quot;18&quot;>No Logo</text></svg>';">
          </div></div>
          <div class="meta">
            <div><div class="title">${ch.name}</div><div class="muted" style="font-size:12px;text-transform:capitalize">${ch.category.replace('+',' + ')}</div></div>
            <div class="badges">${badges(ch)}</div>
          </div>`;
        el.addEventListener('click',()=>openChannel(ch));
        el.addEventListener('keydown',e=>{ if(e.key==='Enter') openChannel(ch);});
        g.appendChild(el);
      });
    }
    $('#filterBar').addEventListener('click',e=>{const btn=e.target.closest('.chip'); if(!btn) return; $$('#filterBar .chip').forEach(x=>x.classList.remove('active')); btn.classList.add('active'); renderChannels(btn.dataset.filter);});

    /* =========================
       Events — Bangladesh Time + Auto prune
       ========================= */
    function renderEvents(){
      const now = new Date();
      const p=$('#eventList'); p.innerHTML='';
      EVENTS.filter(ev=> new Date(ev.end) > now).forEach(ev=>{
        const st=new Date(ev.start), en=new Date(ev.end);
        const live = now>=st && now<=en;
        const timeLabel = live ? 'Live now' : ('Starts ' + formatBD(st,true));
        const tag = live ? 'LIVE' : 'Upcoming';
        const el=document.createElement('div'); el.className='event';
        el.innerHTML=`<div class="ev-left"><img src="${ev.img}" alt="event"></div>
          <div class="ev-mid">
            <div class="ev-title">${ev.title}</div>
            <div class="ev-sub">${formatBD(st,true)} — ${formatBD(en,false)} (BDT)</div>
          </div>
          <div class="ev-right"><div class="etime">${timeLabel}</div><div class="etag">${tag}</div></div>`;
        p.appendChild(el);
      });
    }
    // প্রতি 30 সেকেন্ডে ইভেন্ট লিস্ট আপডেট (শেষ হলে নিজে থেকেই বাদ যাবে)
    setInterval(renderEvents, 30000);

    /* =========================
       Ribbon
       ========================= */
    function renderRibbon(){
      const w=$('#ribTrack');
      const items=RIBBON.map(i=>({img:i.img,title:i.text,type:i.type}));
      const row=items.concat(items);
      w.innerHTML=row.map(i=>`<div class="rib-card">
          <div class="rib-img"><img src="${i.img}" alt="thumb"></div>
          <div class="rib-meta">
            <span class="rib-tag ${i.type}">${i.type==='update'?'Update':i.type==='news'?'News':'Notice'}</span>
            <div class="title" style="font-size:14px">${i.title}</div>
          </div>
        </div>`).join('');
    }

    /* =========================
       Auth
       ========================= */
    const loginOpen=$('#loginOpen'), authModal=$('#authModal'), authClose=$('#authClose'), loginBtn=$('#loginBtn');
    const demoBtn=$('#demoBtn'), logoutBtn=$('#logoutBtn'), profile=$('#profile');
    const uname=$('#username'), upass=$('#password'); const pname=$('#pname'), pexp=$('#pexp'), prole=$('#prole');
    const profileMenu = $('#profileMenu');
    const profileAvatar = $('#profileAvatar');
    const mobileAccount = $('#mobileAccount');

    function showAuth(v){ authModal.classList.toggle('active', v); }
    loginOpen.addEventListener('click',()=>showAuth(true));
    authClose.addEventListener('click',()=>showAuth(false));
    demoBtn.addEventListener('click',()=>{uname.value='pro'; upass.value='pro123';});
    loginBtn.addEventListener('click',doLogin); upass.addEventListener('keydown',e=>{ if(e.key==='Enter') doLogin(); });

    function doLogin(){
      const u=(uname.value||'').trim().toLowerCase(), p=(upass.value||'').trim();
      const rec=ACCOUNTS.find(a=>a.user===u && a.pass===p);
      if(!rec) return alert('Invalid username/password');
      if(isExpired(rec.expires)) return alert('Account expired');
      user={user:rec.user,tier:rec.tier,label:rec.label,expDate:rec.expires};
      sessionStorage.setItem('auth',JSON.stringify(user));
      updateAuthUI(); showAuth(false);
    }
    function doLogout(){ user=null; sessionStorage.removeItem('auth'); updateAuthUI(); }

    logoutBtn.addEventListener('click',doLogout);

    function mobileAccountUI(){
      // ব্যাখ্যা: মোবাইলে অ্যাকাউন্ট অংশ ডায়নামিক — লগ-ইন না থাকলে Login বাটন, থাকলে প্রোফাইল + Logout
      if(user){
        mobileAccount.innerHTML = `
          <div class="mobile-account-header">Account</div>
          <div class="mobile-user">
            <div class="avatar"></div>
            <div style="flex:1">
              <div style="font-weight:800">${user.user.toUpperCase()}</div>
              <div class="muted" style="font-size:12px">Expires: ${formatDate(user.expDate)}</div>
            </div>
            <span class="role ${user.label==='B'?'B':user.label==='Pro'?'Pro':'ProPlus'}">${user.label}</span>
          </div>
          <div class="mobile-account-actions">
            <button class="pill-btn" onclick="alert('Settings coming soon')">Settings</button>
            <button class="pill-btn" onclick="alert('Subscription coming soon')">Subscription</button>
            <button class="pill-btn logout-btn" id="mLogout">Logout</button>
          </div>
        `;
        const mLogout = $('#mLogout'); if(mLogout) mLogout.addEventListener('click', ()=>{ doLogout(); closeMobileMenu(); });
      }else{
        mobileAccount.innerHTML = `
          <div class="mobile-account-header">Account</div>
          <button class="pill-btn login-btn" id="mLogin">Login</button>
          <div class="muted" style="font-size:12px;margin-top:6px">Free channels play without login.</div>
        `;
        const mLogin = $('#mLogin'); if(mLogin) mLogin.addEventListener('click', ()=>{ closeMobileMenu(); showAuth(true); });
      }
    }

    function updateAuthUI(){
      if(user){
        loginOpen.classList.add('hidden'); profile.style.display='flex';
        pname.textContent=user.user.toUpperCase();
        pexp.textContent='Expires: '+formatDate(user.expDate);
        prole.textContent=user.label;
        prole.className='role '+(user.label==='B'?'B':user.label==='Pro'?'Pro':'ProPlus');

        // Profile dropdown detail
        $('#profileName').textContent = user.user.toUpperCase();
        $('#profileTier').textContent = user.label === 'B' ? 'Basic Plan' : user.label === 'Pro' ? 'Pro Plan' : 'Pro+ Plan';
        $('#profileExpiry').textContent = 'Expires: '+formatDate(user.expDate);
      }else{
        loginOpen.classList.remove('hidden'); profile.style.display='none';
      }
      renderChannels($('#filterBar .chip.active').dataset.filter);
      mobileAccountUI();
      computeActionsWidth();
    }
    const saved=sessionStorage.getItem('auth'); if(saved){ try{ const o=JSON.parse(saved); if(!isExpired(o.expDate)) user=o; }catch{} } updateAuthUI();

    // Profile dropdown toggle
    profileAvatar.addEventListener('click', function(e) {
      e.stopPropagation();
      profileMenu.classList.toggle('active');
    });
    // Close profile dropdown when clicking outside
    document.addEventListener('click', function() {
      profileMenu.classList.remove('active');
    });

    /* =========================
       Mobile menu toggle
       ========================= */
    const mobileMenuBtn = $('#mobileMenuBtn');
    const mobileMenu = $('#mobileMenu');
    const mobileOverlay = $('#mobileOverlay');
    const mobileMenuClose = $('#mobileMenuClose');

    function closeMobileMenu() {
      mobileMenu.classList.remove('active');
      mobileOverlay.classList.remove('active');
    }
    mobileMenuBtn.addEventListener('click', function() {
      mobileMenu.classList.add('active');
      mobileOverlay.classList.add('active');
      mobileAccountUI();
    });
    mobileMenuClose.addEventListener('click', closeMobileMenu);
    mobileOverlay.addEventListener('click', closeMobileMenu);
    $$('.mobile-menu-links a').forEach(link => { link.addEventListener('click', closeMobileMenu); });

    /* =========================
       Player (HLS + Custom Controls)
       ========================= */
    const playerModal=$('#playerModal'), video=$('#video'), spinner=$('#spinner'), toast=$('#toast');
    const closePlayer=$('#closePlayer'), closeBtn=$('#closeBtn');
    const pipBtn=$('#pipBtn'), fsBtn=$('#fsBtn');
    const qualityMenu=$('#qualityMenu'), qualityList=$('#qualityList');
    const qualityMenu2=$('#qualityMenu2'), qualityList2=$('#qualityList2');
    const playerTitle=$('#playerTitle');
    const playBtn=$('#playBtn'), playIcon=$('#playIcon'), pauseIcon=$('#pauseIcon');
    const muteBtn=$('#muteBtn'), volIcon=$('#volIcon'), muteIcon=$('#muteIcon'), vol=$('#vol');
    const rewBtn=$('#rewBtn'), fwdBtn=$('#fwdBtn');
    const seek=$('#seek'), curTime=$('#curTime'), durTime=$('#durTime');

    // ভলিউম স্টেট লোকালস্টোরেজে রাখা
    const savedVol = localStorage.getItem('vol'); if(savedVol!==null){ video.volume=parseFloat(savedVol); vol.value=video.volume; video.muted = video.volume===0; }
    vol.addEventListener('input', ()=> localStorage.setItem('vol', vol.value) );

    function showSpinner(v){ spinner.classList.toggle('hidden', !v); }
    function showToast(msg){ toast.textContent=msg; toast.classList.remove('hidden'); setTimeout(()=>toast.classList.add('hidden'), 2400); }

    closePlayer.addEventListener('click', hidePlayer); closeBtn.addEventListener('click', hidePlayer);
    function hidePlayer(){ try{ video.pause(); }catch{} if(hls){ hls.destroy(); hls=null; } playerModal.classList.remove('active'); playerModal.setAttribute('aria-hidden','true'); currentChannel=null; }

    async function openChannel(ch){
      // অ্যাক্সেস কন্ট্রোল: Free হলে login ছাড়াই অনুমতি; নাহলে টায়ার অনুযায়ী
      if(!user && !isFree(ch)) return alert('Please login to watch this channel');
      if(user && !canWatch(ch.tier)) return alert('This channel is locked for your tier');
      currentChannel=ch; playerTitle.textContent=ch.name;
      const brand=$('#playerBrand'); brand.style.animation='none'; void brand.offsetWidth; brand.style.animation='popIn .9s ease both';
      playerModal.classList.add('active'); playerModal.setAttribute('aria-hidden','false');
      setupPlayer(ch.url);
    }
    window.openChannel = (ch)=>openChannel(ch); // ইচ্ছা করলে ডিবাগে ব্যবহার করতে পারেন

    function setupPlayer(url){
      [qualityList, qualityList2].forEach(el=>el.innerHTML=''); [qualityMenu, qualityMenu2].forEach(el=>el.classList.remove('open'));
      if(hls){ try{ hls.destroy(); }catch{} hls=null; } video.src=''; video.controls=false;
      seek.value=0; curTime.textContent='00:00'; durTime.textContent='LIVE'; showSpinner(true);

      // HLS detection
      const isHls = url.includes('.m3u8') || url.includes('.php') || url.includes('.m3u');
      if(isHls && Hls.isSupported()){
        // HLS টিউন — স্মুথ প্লেব্যাক/লো-লেটেন্সি
        hls=new Hls({
          enableWorker:true,
          lowLatencyMode:true,
          backBufferLength: 60,
          maxBufferLength: 30,
          maxMaxBufferLength: 120,
          liveSyncDuration: 3,
          liveMaxLatencyDuration: 10,
          startLevel: -1,
          capLevelToPlayerSize:true,
          progressive:true
        });
        hls.loadSource(url); hls.attachMedia(video);
        hls.on(Hls.Events.MANIFEST_PARSED, ()=>{ buildQuality(hls.levels); video.play().catch(()=>{}); showSpinner(false); });
        hls.on(Hls.Events.LEVEL_SWITCHED, (_,data)=>{ /* চাইলে active quality UI-তে হাইলাইট করতে পারেন */ });
        hls.on(Hls.Events.ERROR,(_,data)=>{ if(data?.fatal){ showToast('Stream error'); } });
      }else if(video.canPlayType('application/vnd.apple.mpegurl') && isHls){
        // iOS Safari সরাসরি m3u8 সাপোর্ট করে
        video.src=url; video.addEventListener('loadedmetadata',()=>video.play().catch(()=>{}),{once:true});
        buildQuality([]); showSpinner(false);
      }else{
        // Direct file (যদি .ts/.mp4 ইত্যাদি হয়)
        video.src=url; video.play().catch(()=>{}); buildQuality([]); showSpinner(false);
      }
    }

    function buildQuality(levels){
      const opts=[{label:'Auto',level:-1}]; const seen=new Set();
      if(levels && levels.length){
        // বড় height আগে দেখাতে sort
        const copy = levels.slice().sort((a,b)=>b.height-a.height);
        copy.forEach(lv=>{ if(!seen.has(lv.height)){ seen.add(lv.height); opts.push({label:lv.height+'p', level: levels.indexOf(lv)}); }});
      }
      [qualityList, qualityList2].forEach(list=>{
        list.innerHTML='';
        opts.forEach(opt=>{
          const b=document.createElement('button'); b.className='ctl'; b.textContent=opt.label;
          b.addEventListener('click',()=>{ if(hls) hls.currentLevel=opt.level; list.parentElement.classList.remove('open'); });
          list.appendChild(b);
        });
      });
      // toggle + outside click close (persistent)
      [qualityMenu, qualityMenu2].forEach(menu=>{
        menu.onclick=e=>{ e.stopPropagation(); menu.classList.toggle('open'); };
      });
      document.addEventListener('click',()=>{ qualityMenu.classList.remove('open'); qualityMenu2.classList.remove('open'); });
    }

    // Video events
    video.addEventListener('playing', ()=>showSpinner(false));
    video.addEventListener('waiting', ()=>showSpinner(true));
    video.addEventListener('pause', ()=>{ showSpinner(false); updatePlayIcons(); });
    video.addEventListener('play', ()=>{ updatePlayIcons(); });
    video.addEventListener('loadedmetadata', ()=>{
      showSpinner(false);
      if(isFinite(video.duration)){ durTime.textContent=fmt(video.duration); }
    });
    video.addEventListener('timeupdate', ()=>{
      if(isFinite(video.duration) && video.duration>0){
        seek.value = (video.currentTime/video.duration)*100;
        curTime.textContent=fmt(video.currentTime);
        durTime.textContent=fmt(video.duration);
      }else{
        curTime.textContent='LIVE'; durTime.textContent='LIVE'; seek.value=0;
      }
    });
    video.addEventListener('error', ()=>{ showSpinner(false); showToast('Playback error'); });

    // Controls
    function updatePlayIcons(){ const playing = !video.paused && !video.ended; playIcon.style.display = playing ? 'none':'inline'; pauseIcon.style.display = playing ? 'inline':'none'; }
    playBtn.addEventListener('click', ()=>{ if(video.paused) video.play().catch(()=>{}); else video.pause(); updatePlayIcons(); });
    rewBtn.addEventListener('click', ()=>{ try{ video.currentTime = Math.max(0, video.currentTime-10); }catch{} });
    fwdBtn.addEventListener('click', ()=>{ try{ video.currentTime = isFinite(video.duration)? Math.min(video.duration, video.currentTime+10) : video.currentTime+10; }catch{} });
    muteBtn.addEventListener('click', ()=>{ video.muted=!video.muted; volIcon.style.display = video.muted?'none':'inline'; muteIcon.style.display = video.muted?'inline':'none'; });
    vol.addEventListener('input', ()=>{ video.volume=parseFloat(vol.value); video.muted = video.volume===0; volIcon.style.display = video.muted?'none':'inline'; muteIcon.style.display = video.muted?'inline':'none'; });
    seek.addEventListener('input', ()=>{ if(isFinite(video.duration) && video.duration>0){ const t=(seek.value/100)*video.duration; try{ video.currentTime=t; }catch{} } });

    // PiP / Fullscreen
    $('#pipBtn').addEventListener('click', async ()=>{
      try{ if(document.pictureInPictureElement){ await document.exitPictureInPicture(); } else if(video.requestPictureInPicture){ await video.requestPictureInPicture(); } }catch(e){}
    });
    $('#fsBtn').addEventListener('click', ()=>{ const root=$('.modal-body'); if(document.fullscreenElement) document.exitFullscreen(); else root.requestFullscreen?.(); });

    // Keyboard shortcuts (player active অবস্থায়)
    document.addEventListener('keydown', e=>{
      if(!playerModal.classList.contains('active')) return;
      if(e.code==='Space'){ e.preventDefault(); if(video.paused) video.play().catch(()=>{}); else video.pause(); updatePlayIcons(); }
      if(e.code==='ArrowLeft'){ video.currentTime=Math.max(0, video.currentTime-5); }
      if(e.code==='ArrowRight'){ video.currentTime=video.currentTime+5; }
      if(e.key.toLowerCase()==='m'){ video.muted=!video.muted; volIcon.style.display=video.muted?'none':'inline'; muteIcon.style.display=video.muted?'inline':'none'; }
      if(e.key.toLowerCase()==='f'){ $('#fsBtn').click(); }
      if(e.key==='Escape'){ hidePlayer(); }
    });

    function fmt(sec){ sec=Math.floor(sec||0); const m=String(Math.floor(sec/60)).padStart(2,'0'); const s=String(sec%60).padStart(2,'0'); return `${m}:${s}`; }

    /* =========================
       INIT
       ========================= */
    function init(){
      renderInfoRail('notice'); startInfoRotate();
      renderRibbon();
      initSlider(); renderChannels('all'); renderEvents();
      computeActionsWidth();

      // Splash auto-hide (safety)
      setTimeout(()=>{ const s=$('#splash'); s && (s.style.display='none'); }, 2500);
    }
    init();

    /* ============================================================
       টিপস/ডকুমেন্টেশন (BN):
       - ACCOUNTS: নতুন ইউজার যোগ করতে ACCOUNTS অ্যারেতে {user,pass,tier,expires,label} যোগ করুন
         tier: 'basic' | 'pro' | 'ultra'  (ultra = Pro+)
         label: 'B' | 'Pro' | 'Pro+'
       - CHANNELS: চ্যানেল যোগ/এডিট করুন; Free করতে badges-এ 'Free' দিন
         tier: কোন প্ল্যান প্রয়োজন, যেমন 'basic' (Free হলেও tier basic রাখতে পারেন)
       - Free policy: isFree(ch) true হলে login ছাড়া play হবে
       - Non-free policy: login + canWatch(tier) চেক হয়
       - EVENTS: Bangladesh time দেখাতে start/end ISO-তে +06:00 দিয়ে দিন (Asia/Dhaka)
         উদাহরণ: '2025-10-07T20:30:00+06:00'
         renderEvents() নিজে থেকেই শেষ হয়ে গেলে ইভেন্ট বাদ দেয় (setInterval 30s)
       - Info Rail: renderInfoRail + startInfoRotate() ট্যাব অটো-রোটেট করবে
       - Player: HLS config টিউন করা হয়েছে; প্রয়োজনে network/latency অনুযায়ী মান fine-tune করতে পারেন
       - CSS: premium glass look; প্রয়োজনে :root ভ্যারিয়েবল থেকে কালার/রেডিয়াস/শ্যাডো টিউন করুন
       - Dev note: আগের anti-devtools/selection-block কোড সরানো হয়েছে (ডিবাগিং সহজ রাখতে)
    ============================================================ */
  })();
  </script>
</body>
</html>
